(function(){var a;a=window.HarvestToBigtime||(window.HarvestToBigtime={}),function(a,b){var c,d,e,f,g,h;return c=function(){var b;return b=g(e()),f("ProjectNm"),h({thisHappens:function(){return d("Projects")},doThis:function(){return a('#tableSection a.list-item:contains("'+b.project+'")',a("#IF_DIALOG")[0].contentWindow.document).trigger("click"),f("LK_SHOW_CatSID"),h({thisHappens:function(){return d("Expense Categories")},doThis:function(){return a('#tableSection .list-item a:contains("'+b.category+'")',a("#IF_DIALOG")[0].contentWindow.document).trigger("click"),a(":input[name=Dt]").val(b.date),a(":input[name=CostIN]").val(b.cost),a("textarea[name=Nt]").text(b.notes),a("#cmdGO").trigger("click")}})}})},f=function(b){return a(':input[name="'+b+'"]').siblings("img").trigger("click")},h=function(a){var b;return b=setInterval(function(){if(a.thisHappens())return a.doThis(),clearInterval(b)},100)},e=function(){var a,b,c;return a=(sessionStorage.harvestExpenseReport||prompt("Paste your Harvest CSV export:").split("\n").slice(1).join("\n")).split("\n"),b=a.shift(),c=a.join("\n"),/\S/.test(c)?sessionStorage.harvestExpenseReport=c:delete sessionStorage.harvestExpenseReport,b},g=function(a){var b;return b=a.split(/,(?=(?:[^\"]*\"[^\"]*\")*(?![^\"]*\"))/),{date:function(){var a;return a="2011-11-28".split(/-/),a[1]+"/"+a[2]+"/"+a[0]}(),project:b[2],category:b[4],cost:b[9],notes:b[8]}},d=function(b){return a('#tableSection .list-head:contains("'+b+'")',a("#IF_DIALOG")[0].contentWindow.document).is(":visible")},a(function(){a('<span class="quick-add-expense">Quick Expense</span>').insertAfter("#cmdGO").css({display:"inline-block",padding:"3px",background:"white",border:"1px solid black",margin:"0px 15px 0px 5px",cursor:"hand"}).on("click",c);if(sessionStorage.harvestExpenseReport)return c()})}(a.$,a._)}).call(this);
